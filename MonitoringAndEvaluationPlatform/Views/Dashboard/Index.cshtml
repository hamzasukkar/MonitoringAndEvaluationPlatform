@model MonitoringAndEvaluationPlatform.ViewModel.DashboardSummaryViewModel
@{
    ViewData["Title"] = "Summary";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<divp style="padding-top: 10px;" class="row text-center g-4 mb-4">
    <div class="col-md-3">
        <div class="card shadow-lg border-0 bg-primary text-white">
            <div class="card-body">
                <i class="bi bi-diagram-3-fill display-5 mb-2"></i>
                <h5 class="card-title">Frameworks</h5>
                <h2 class="fw-bold">@Model.TotalFrameworks</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card shadow-lg border-0 bg-success text-white">
            <div class="card-body">
                <i class="bi bi-bar-chart-fill display-5 mb-2"></i>
                <h5 class="card-title">Indicators</h5>
                <h2 class="fw-bold">@Model.TotalIndicators</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card shadow-lg border-0 bg-warning text-dark">
            <div class="card-body">
                <i class="bi bi-building display-5 mb-2"></i>
                <h5 class="card-title">Projects</h5>
                <h2 class="fw-bold">@Model.TotalProjects</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card shadow-lg border-0 bg-danger text-white">
            <div class="card-body">
                <i class="bi bi-geo-alt-fill display-5 mb-2"></i>
                <h5 class="card-title">Regions</h5>
                <h2 class="fw-bold">@Model.TotalRegions</h2>
            </div>
        </div>
    </div>
</divp>

<div style="width:50%;height:50%" class="card shadow-sm p-4 mb-4">
    <h5 class="mb-3">Framework Achievement Rate</h5>
    <canvas id="gaugeChart" style="width:50%;height:50%"></canvas>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-doughnutlabel@1.0.3"></script>

<script>
    async function loadGauge(frameworkCode) {
        const response = await fetch(`/Dashboard/FrameworkGauge?frameworkCode=${frameworkCode}`);
        const data = await response.json();

        const rate = data.rate;

        const ctx = document.getElementById('gaugeChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [rate, 100 - rate],
                    backgroundColor: ['#00c853', '#e0e0e0'],
                    borderWidth: 0,
                    cutout: '80%'
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: false },
                    doughnutlabel: {
                        labels: [
                            { text: rate + '%', font: { size: '30' } },
                            { text: 'Achieved' }
                        ]
                    }
                }
            }
        });
    }

    // Load with default framework (you can change this dynamically)
    loadGauge(1);
</script>

