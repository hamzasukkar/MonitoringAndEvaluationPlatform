@model MonitoringAndEvaluationPlatform.ViewModel.DashboardSummaryViewModel
@{
	ViewData["Title"] = "Summary";
	Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}
<head>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<divp style="padding-top: 10px;" class="row text-center g-4 mb-4">
	<div class="col-md-3">
		<div class="card shadow-lg border-0 bg-primary text-white">
			<div class="card-body">
				<i class="bi bi-diagram-3-fill display-5 mb-2"></i>
				<h5 class="card-title">Frameworks</h5>
				<h2 class="fw-bold">@Model.TotalFrameworks</h2>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card shadow-lg border-0 bg-success text-white">
			<div class="card-body">
				<i class="bi bi-bar-chart-fill display-5 mb-2"></i>
				<h5 class="card-title">Indicators</h5>
				<h2 class="fw-bold">@Model.TotalIndicators</h2>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card shadow-lg border-0 bg-warning text-dark">
			<div class="card-body">
				<i class="bi bi-building display-5 mb-2"></i>
				<h5 class="card-title">Projects</h5>
				<h2 class="fw-bold">@Model.TotalProjects</h2>
			</div>
		</div>
	</div>
	<div class="col-md-3">
		<div class="card shadow-lg border-0 bg-danger text-white">
			<div class="card-body">
				<i class="bi bi-geo-alt-fill display-5 mb-2"></i>
				<h5 class="card-title">Regions</h5>
				<h2 class="fw-bold">@Model.TotalRegions</h2>
			</div>
		</div>
	</div>
</divp>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-doughnutlabel@1.0.3"></script>

<div id="gaugesContainer" class="row"></div>

<script>
        async function loadGauges() {
        const response = await fetch('/Dashboard/FrameworksGauge');
        const frameworks = await response.json();

        const container = document.getElementById('gaugesContainer');
        container.innerHTML = '';

        frameworks.forEach(framework => {
            // Create card element
            const card = document.createElement('div');
            card.className = 'col-md-4 mb-4';
            card.innerHTML = `
                <div class="card shadow-sm p-4 text-center">
                    <h5 class="mb-3">${framework.name}</h5>
                    <canvas id="gaugeChart_${framework.code}" height="200"></canvas>
                    <div class="mt-3 fw-bold" style="font-size: 1.2rem; color: #00c853;">
                        ${framework.rate}% Achieved
                    </div>
                </div>
            `;

            container.appendChild(card);

            // Initialize Chart
            const ctx = document.getElementById(`gaugeChart_${framework.code}`).getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [framework.rate, 100 - framework.rate],
                        backgroundColor: ['#00c853', '#e0e0e0'],
                        borderWidth: 0,
                        cutout: '80%'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false },
                        doughnutlabel: {
                            labels: [
                                {
                                    text: `${framework.rate}%`,
                                    font: {
                                        size: 24,
                                        weight: 'bold'
                                    },
                                    color: '#00c853'
                                },
                                {
                                    text: 'Achieved',
                                    font: {
                                        size: 14
                                    },
                                    color: '#666'
                                }
                            ]
                        }
                    }
                }
            });
        });
    }

	// Call the function on page load
	loadGauges();
</script>

